#include<stdio.h>
#include<string.h>


unsigned char shellcode[] =
"\xFF\xEE\xDD\xCC\xBB\xAA\x99\x88" //tag in reverse
"\x48\x31\xc0\x48\x83\xc0\x01\x48\x89\xc7\x68\x72\x6c\x64\x0a\x48\xbb\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x53\x48\x89\xe6\x48\x31\xd2\x48\x83\xc2\x0c\x0f\x05\x48\x31\xc0\x48\x83\xc0\x3c\x48\x31\xff\x0f\x05"
;

unsigned char egghunter[] =
"\xeb\x27\x5f\x48\x83\xef\x2e\x48\xb8\xff\xee\xdd\xcc\xbb\xaa\x99\x88\x48\x31\xc9\x66\xb9\xff\xff\xfd\x48\xaf\x74\x06\x48\x83\xc7\x07\xe2\xf6\x48\x83\xc7\x10\xff\xe7\xe8\xd4\xff\xff\xff"
;

main()
{
	printf("Egghunter Length: %d\n", (int)strlen(egghunter));
	printf("Shellcode Length: %d\n", (int)strlen(shellcode));

	int (*ret)() = (int(*)())egghunter;
//	int (*ret)() = (int(*)())shellcode+8;
	ret();
}
